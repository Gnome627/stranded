<?xml version="1.0" encoding="windows-1251" standalone="yes" ?>
<triggers>

	<!-- World creation -->

	<trigger Name="GlobalThings" active="1">
		<event timeout="0.01" eventid="GE_TIME_PERIOD" />
		<script>
			SetRadarUpgrade(1)
			g_ObjCont:SetGameTime( 12, 0, 11, 5, 2602 )
			RuleConsole("lsViewDistanceDivider 0.1")
			EnableAutoHelp( false )
			
			skins = {1, 3, 5, 7}
			GetPlayerVehicle():SetSkin(skins[random(1, getn(skins))])

			local town = GetEntityByName("PetrolStationTown")
			if town then
				town:SetRuined( true )
				town:SetOpenGateToPlayer( false )
			end
			
			TActivate("CreateHealingStationLevelZero")
			TActivate("CreateFuelingStationLevelZero")
			TActivate("CreateStationsIndicators")
			TActivate("CreateWarehouse")
			TActivate("CreateArena")

            AddFadingMsgId( "fm_history_got" )
			AddHistory( "stranded_1" )

   			TakeQuest( "Stranded_Quest1" )
			TActivate("tr_Stranded_Quest1_1")

			TActivate("Artefact1RedBubu")
			--TActivate("tr_AbdulHouse")
			TActivate("GameStart_Scene0")

			CreateNewDummyObject( "stranded_artefact1", "artefact1_dummy", -1, -1, CVector(5640.000, 311.350, 5546.800), Quaternion(0.0000, 0.4000, 0.0000, 0.8000), 1 )

			trigger:Deactivate()
		</script>
	</trigger>

	<!--trigger Name="tr_AbdulHouse" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="DesertHouseLoc" />
		<script>
			if  IsQuestTaken("Stranded_Quest1") and not(IsQuestComplete("Stranded_Quest1")) then
				AddImportantFadingMsgId("fm_abdul")
				trigger:Deactivate() 
			end   
		</script>
	</trigger-->
	
	<trigger Name="tr_Stranded_Quest1_1" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="DesertTownQLoc" />
		<script>
			if  IsQuestTaken("Stranded_Quest1") and not(IsQuestComplete("Stranded_Quest1")) then
				CompleteQuest( "Stranded_Quest1" )
				TakeQuest( "Stranded_Quest2" )

				TDeactivate("tr_AbdulHouse")
				trigger:Deactivate() 
			end   
		</script>
	</trigger>

	<trigger Name="tr_Guy3Quest" active="0">
		<event timeout="0.03" eventid="GE_TIME_PERIOD" />
		<script>
			TeamCreate("GamblerTeam", 1071, CVector(4007.185, 316.360, 4867.610), {"GamblerCar"})
			GetEntityByName("GamblerTeam_vehicle_0"):SetSkin(3)
			GetEntityByName("GamblerTeam_vehicle_0"):SetRotation(Quaternion(0.034, -0.827, 0.026, -0.561))

			TActivate("tr_CheckGamblerDie")
			TActivate("tr_Guy3TakeQuest")
			trigger:Deactivate()
		</script>
	</trigger>
	
	<trigger Name="tr_Guy3TakeQuest" active="0">
		<event timeout="0.05" eventid="GE_TIME_PERIOD" />
		<script>
			TakeQuest('Stranded_Quest2SubQuest')
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="tr_CheckGamblerDie" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="GamblerTeam" />
		<script>
			CompleteQuest("Stranded_Quest2SubQuest_1")
			AddQuestItem("quest_container")
			AddFadingMsgByStrIdFormatted( "fm_player_add_thing", "quest_container")
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="tr_Guy3QuestFailed" active="0">
		<event timeout="0.03" eventid="GE_TIME_PERIOD" />
		<script>
			if GetEntityByName("GamblerTeam_vehicle_0") then
				GetEntityByName("GamblerTeam_vehicle_0"):Remove()
			end

			TDeactivate("tr_CheckGamblerDie")
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="tr_ScienceBitch" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="YLoc12" />
		<script>
			if  IsQuestTaken("Stranded_SciencerQuest_1") and not(IsQuestComplete("Stranded_SciencerQuest_1")) then
				CompleteQuest( "Stranded_SciencerQuest_1" )
				trigger:Deactivate() 
			end   
		</script>
	</trigger>

	<trigger Name="Artefact1RedBubu" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Artefact1Loc1" />
		<script>
			CreateEffectTTLed( "ET_PS_LENS_D1", CVector(GetPlayerVehicle():GetPosition()) + CVector(random(-5, 5), random(2, 6), random(-5, 5)), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), random(2000,6000))
			CreateEffectTTLed( "ET_PS_LENS_D1", CVector(GetPlayerVehicle():GetPosition()) + CVector(random(-5, 5), random(2, 6), random(-5, 5)), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), random(2000,6000))
			CreateEffectTTLed( "ET_PS_LENS_D1", CVector(GetPlayerVehicle():GetPosition()) + CVector(random(-5, 5), random(2, 6), random(-5, 5)), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), random(2000,6000))
			CreateEffectTTLed( "ET_PS_LENS_D1", CVector(GetPlayerVehicle():GetPosition()) + CVector(random(-5, 5), random(2, 6), random(-5, 5)), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), random(2000,6000))
		</script>
	</trigger>

	<trigger Name="tr_Artefact1" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Artefact1Loc1" />
		<script>
			TDeactivate("Artefact1RedBubu")
			TActivate("Artefact1Cin")
			TActivate("tr_Artefact1Lookout")

			GetPlayerVehicle():SetCustomLinearVelocity(0)
			GetPlayerVehicle():SetThrottle(0)
			GetPlayerVehicle():SetCustomControlEnabled(true)

			AllowSave( false )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="tr_Artefact1Lookout" active="0">
		<event eventid="GE_OBJECT_LEAVES_LOCATION" ObjName="Artefact1LocLookout" />
		<script>
			box = SpawnMessageBox("9991")
			ShowDeathMenu()
			AllowSave( true )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="tr_Artefact1Shuffle" active="0">
		<event timeout="0.01" eventid="GE_TIME_PERIOD" />
		<script>
			positions = {1, 2, 3, 4}
			c = 1
			playerseed = {}

			local j
			for i = 1, getn(positions) do
        		j = random( i )
        		positions[i], positions[j] = positions[j], positions[i]
    		end
			local seed = positions[1]..positions[2]..positions[3]..positions[4]
			println('seed='..seed)

			TActivate('tr_Artefact1Light'..positions[c])
			TActivate('tr_Artefact1CheckPlayerSeed')

			trigger:Deactivate()
		</script>
	</trigger>


	<trigger Name="tr_Artefact1CheckPlayerSeed" active="0">
		<event timeout="0.5" eventid="GE_TIME_PERIOD" />
		<script>
			if getn(playerseed) > 3 then
				local playerseedstr
				playerseedstr = playerseed[1]..playerseed[2]..playerseed[3]..playerseed[4]
				println('playerseedstr='..playerseedstr)
				local seed = positions[1]..positions[2]..positions[3]..positions[4]
				if playerseedstr == seed then
					CompleteQuest('Stranded_Quest3_2')
					AllowSave( true )

					for i = 1, 4 do
						local lens = GetEntityByName('art1_nlens'..i)
						local smoke = GetEntityByName('art1_smoke'..i)
						if lens then lens:Remove() end
						if smoke then smoke:Remove() end
					end

					if GetEntityByName("artefact1_dummy") then GetEntityByName("artefact1_dummy"):Remove() end
					if GetEntityByName("art1_dummyeffect") then GetEntityByName("art1_dummyeffect"):Remove() end
					AddQuestItem("quest_artefact1")
					AddFadingMsgByStrIdFormatted( "fm_player_add_thing", "quest_artefact1")

					CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(GetPlayerVehicle():GetPosition()), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)
					CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(getPos("Artefact1Loc1")) + CVector(0, 2, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)
					CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(getPos("Artefact1Loc2")) + CVector(0, 2, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)
					CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(getPos("Artefact1Loc3")) + CVector(0, 2, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)
					CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(getPos("Artefact1Loc4")) + CVector(0, 2, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)

					TDeactivate("tr_Artefact1Lookout")
					trigger:Deactivate()
				else
					println('player seed false')
					playerseed = {}
					
					for i = 1, 4 do
						local smoke = GetEntityByName('art1_smoke'..i)
						if smoke then smoke:Remove() end
					end

					TActivate('tr_Artefact1Loc1ToSeed')
					TActivate('tr_Artefact1Loc2ToSeed')
					TActivate('tr_Artefact1Loc3ToSeed')
					TActivate('tr_Artefact1Loc4ToSeed')

					AddImportantFadingMsgId("fm_wrong_seed")
				end
			end
		</script>
	</trigger>

	<trigger Name="tr_Artefact1Loc1ToSeed" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Artefact1Loc1" />
		<script>
			table.insert(playerseed, 1)
			CreateNewSgNodeObject( "ET_PS_BOSS1_SMOKE", "art1_smoke1", -1, -1, CVector(getPos("Artefact1Loc1")), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="tr_Artefact1Loc2ToSeed" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Artefact1Loc2" />
		<script>
			table.insert(playerseed, 2)
			CreateNewSgNodeObject( "ET_PS_BOSS1_SMOKE", "art1_smoke2", -1, -1, CVector(getPos("Artefact1Loc2")), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="tr_Artefact1Loc3ToSeed" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Artefact1Loc3" />
		<script>
			table.insert(playerseed, 3)
			CreateNewSgNodeObject( "ET_PS_BOSS1_SMOKE", "art1_smoke3", -1, -1, CVector(getPos("Artefact1Loc3")), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="tr_Artefact1Loc4ToSeed" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Artefact1Loc4" />
		<script>
			table.insert(playerseed, 4)
			CreateNewSgNodeObject( "ET_PS_BOSS1_SMOKE", "art1_smoke4", -1, -1, CVector(getPos("Artefact1Loc4")), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="tr_Artefact2" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="BigHomeLoc" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="DesertTownQLoc" />
		<script>
			TActivate("Artefact2Cin")

			GetPlayerVehicle():SetCustomLinearVelocity(0)
			GetPlayerVehicle():SetThrottle(0)
			GetPlayerVehicle():SetCustomControlEnabled(true)

            AddFadingMsgId( "fm_history_got" )
			AddHistory( "stranded_5" )

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="Artefact2ContinueQuest" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Artefact2Loc" />
		<script>
			CompleteQuest('Stranded_Artefact2_Quest_1')

			TActivate('tr_Artefact2Loc1')
			TActivate('tr_Artefact2Loc2')
			TActivate('tr_Artefact2Loc3')
			TActivate('tr_Artefact2Loc4')

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="tr_Artefact2Loc1" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Artefact2Loc1" />
		<script>
			local goods = {"potato", "scrap_metal", "firewood", "machinery", "oil", "fuel", "book", "tobacco", "electronics"}
			if GetPlayerVehicle():HasAmountOfItemsInRepository(goods[GetEntityByName("art2_ware1"):GetSkin()], 1) then
				RemoveItemsFromPlayerRepository(goods[GetEntityByName("art2_ware1"):GetSkin()], 1)
				local lens = GetEntityByName("art2_lens1")
				if lens then
					lens:Remove()
					CreateNewSgNodeObject( "ET_PS_LENS_S9", "art2_nlens1", -1, -1, CVector(getPos("Artefact2Loc1")) + CVector(0, 13, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				end
				CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(getPos("Artefact2Loc1")) + CVector(0, 16, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)
				TActivate('tr_Artefact2Check')
				trigger:Deactivate()
			else
				CreateEffectTTLed( "ET_PS_LENS_D1", CVector(GetPlayerVehicle():GetPosition()) + CVector(random(-5, 5), random(2, 6), random(-5, 5)), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), random(2000,6000))
				CreateEffectTTLed( "ET_PS_LENS_D1", CVector(GetPlayerVehicle():GetPosition()) + CVector(random(-5, 5), random(2, 6), random(-5, 5)), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), random(2000,6000))
				CreateEffectTTLed( "ET_PS_LENS_D1", CVector(GetPlayerVehicle():GetPosition()) + CVector(random(-5, 5), random(2, 6), random(-5, 5)), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), random(2000,6000))
				CreateEffectTTLed( "ET_PS_LENS_D1", CVector(GetPlayerVehicle():GetPosition()) + CVector(random(-5, 5), random(2, 6), random(-5, 5)), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), random(2000,6000))
				println('red bububu')
			end
		</script>
	</trigger>

	<trigger Name="tr_Artefact2Loc2" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Artefact2Loc2" />
		<script>
			local goods = {"potato", "scrap_metal", "firewood", "machinery", "oil", "fuel", "book", "tobacco", "electronics"}
			if GetPlayerVehicle():HasAmountOfItemsInRepository(goods[GetEntityByName("art2_ware2"):GetSkin()], 1) then
				RemoveItemsFromPlayerRepository(goods[GetEntityByName("art2_ware2"):GetSkin()], 1)
				local lens = GetEntityByName("art2_lens2")
				if lens then
					lens:Remove()
					CreateNewSgNodeObject( "ET_PS_LENS_S9", "art2_nlens2", -1, -1, CVector(getPos("Artefact2Loc2")) + CVector(0, 13, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				end
				CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(getPos("Artefact2Loc2")) + CVector(0, 16, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)
				TActivate('tr_Artefact2Check')
				trigger:Deactivate()
			else
				CreateEffectTTLed( "ET_PS_LENS_D1", CVector(GetPlayerVehicle():GetPosition()) + CVector(random(-5, 5), random(2, 6), random(-5, 5)), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), random(2000,6000))
				CreateEffectTTLed( "ET_PS_LENS_D1", CVector(GetPlayerVehicle():GetPosition()) + CVector(random(-5, 5), random(2, 6), random(-5, 5)), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), random(2000,6000))
				CreateEffectTTLed( "ET_PS_LENS_D1", CVector(GetPlayerVehicle():GetPosition()) + CVector(random(-5, 5), random(2, 6), random(-5, 5)), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), random(2000,6000))
				CreateEffectTTLed( "ET_PS_LENS_D1", CVector(GetPlayerVehicle():GetPosition()) + CVector(random(-5, 5), random(2, 6), random(-5, 5)), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), random(2000,6000))
				println('red bububu')
			end
		</script>
	</trigger>

	<trigger Name="tr_Artefact2Loc3" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Artefact2Loc3" />
		<script>
			local goods = {"potato", "scrap_metal", "firewood", "machinery", "oil", "fuel", "book", "tobacco", "electronics"}
			if GetPlayerVehicle():HasAmountOfItemsInRepository(goods[GetEntityByName("art2_ware3"):GetSkin()], 1) then
				RemoveItemsFromPlayerRepository(goods[GetEntityByName("art2_ware3"):GetSkin()], 1)
				local lens = GetEntityByName("art2_lens3")
				if lens then
					lens:Remove()
					CreateNewSgNodeObject( "ET_PS_LENS_S9", "art2_nlens3", -1, -1, CVector(getPos("Artefact2Loc3")) + CVector(0, 13, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				end
				CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(getPos("Artefact2Loc3")) + CVector(0, 16, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)
				TActivate('tr_Artefact2Check')
				trigger:Deactivate()
			else
				CreateEffectTTLed( "ET_PS_LENS_D1", CVector(GetPlayerVehicle():GetPosition()) + CVector(random(-5, 5), random(2, 6), random(-5, 5)), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), random(2000,6000))
				CreateEffectTTLed( "ET_PS_LENS_D1", CVector(GetPlayerVehicle():GetPosition()) + CVector(random(-5, 5), random(2, 6), random(-5, 5)), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), random(2000,6000))
				CreateEffectTTLed( "ET_PS_LENS_D1", CVector(GetPlayerVehicle():GetPosition()) + CVector(random(-5, 5), random(2, 6), random(-5, 5)), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), random(2000,6000))
				CreateEffectTTLed( "ET_PS_LENS_D1", CVector(GetPlayerVehicle():GetPosition()) + CVector(random(-5, 5), random(2, 6), random(-5, 5)), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), random(2000,6000))
				println('red bububu')
			end
		</script>
	</trigger>

	<trigger Name="tr_Artefact2Loc4" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Artefact2Loc4" />
		<script>
			local goods = {"potato", "scrap_metal", "firewood", "machinery", "oil", "fuel", "book", "tobacco", "electronics"}
			if GetPlayerVehicle():HasAmountOfItemsInRepository(goods[GetEntityByName("art2_ware4"):GetSkin()], 1) then
				RemoveItemsFromPlayerRepository(goods[GetEntityByName("art2_ware4"):GetSkin()], 1)
				local lens = GetEntityByName("art2_lens4")
				if lens then
					lens:Remove()
					CreateNewSgNodeObject( "ET_PS_LENS_S9", "art2_nlens4", -1, -1, CVector(getPos("Artefact2Loc4")) + CVector(0, 13, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				end
				CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(getPos("Artefact2Loc4")) + CVector(0, 16, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)
				TActivate('tr_Artefact2Check')
				trigger:Deactivate()
			else
				CreateEffectTTLed( "ET_PS_LENS_D1", CVector(GetPlayerVehicle():GetPosition()) + CVector(random(-5, 5), random(2, 6), random(-5, 5)), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), random(2000,6000))
				CreateEffectTTLed( "ET_PS_LENS_D1", CVector(GetPlayerVehicle():GetPosition()) + CVector(random(-5, 5), random(2, 6), random(-5, 5)), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), random(2000,6000))
				CreateEffectTTLed( "ET_PS_LENS_D1", CVector(GetPlayerVehicle():GetPosition()) + CVector(random(-5, 5), random(2, 6), random(-5, 5)), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), random(2000,6000))
				CreateEffectTTLed( "ET_PS_LENS_D1", CVector(GetPlayerVehicle():GetPosition()) + CVector(random(-5, 5), random(2, 6), random(-5, 5)), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), random(2000,6000))
				println('red bububu')
			end
		</script>
	</trigger>


	<trigger Name="tr_Artefact2Check" active="0">
		<event timeout="0.1" eventid="GE_TIME_PERIOD" />
		<script>
			local nlens1 = GetEntityByName('art2_nlens1')
			local nlens2 = GetEntityByName('art2_nlens2')
			local nlens3 = GetEntityByName('art2_nlens3')
			local nlens4 = GetEntityByName('art2_nlens4')

			if nlens1 and nlens2 and nlens3 and nlens4 then
				CompleteQuest('Stranded_Artefact2_Quest_2')
				AddQuestItem('quest_artefact2')
				AddFadingMsgByStrIdFormatted( "fm_player_add_thing", "quest_artefact2")

            	AddFadingMsgId( "fm_history_got" )
				AddHistory( "stranded_a1" )

				TDeactivate('tr_Artefact2Loc1')
				TDeactivate('tr_Artefact2Loc2')
				TDeactivate('tr_Artefact2Loc3')
				TDeactivate('tr_Artefact2Loc4')

				CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(GetPlayerVehicle():GetPosition()), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)
				CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(getPos("Artefact2Loc1")) + CVector(0, 16, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)
				CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(getPos("Artefact2Loc2")) + CVector(0, 16, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)
				CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(getPos("Artefact2Loc3")) + CVector(0, 16, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)
				CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(getPos("Artefact2Loc4")) + CVector(0, 16, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)

				if GetEntityByName('art2_dummy') then GetEntityByName('art2_dummy'):Remove() end
				if GetEntityByName('art2_dummyeffect') then GetEntityByName('art2_dummyeffect'):Remove() end
			else
				println('not enough good(s)')
			end

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="tr_Artefact4" active="0">
		<event timeout="0.1" eventid="GE_TIME_PERIOD" />
		<script>
			TActivate('tr_CreateGloohoe')
			TActivate('tr_CreateArtefact4Pyotr')

			AllowSave( false )
			GetPlayerVehicle():SetCustomLinearVelocity(0)
			GetPlayerVehicle():SetThrottle(0)

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="tr_CreateGloohoe" active="0">
		<event 	timeout="0.01" eventid="GE_TIME_PERIOD" />
		<script>
			CreateNewDummyObject( "pyotrarena",	"hs00", -1, -1, CVector(GetPlayerVehicle():GetPosition()), Quaternion(0.0000, 0.000, 0.0000, 1.000), 1 )
			--CreateNewDummyObject( "workshop2",	"hs01", -1, -1, CVector(GetPlayerVehicle():GetPosition()) + CVector(8.331, 0, -15.889), Quaternion(0.0000, -0.9998, 0.0000, -0.0196),1 )
			--CreateNewDummyObject( "house1",	"hs02", -1, -1, CVector(GetPlayerVehicle():GetPosition()) + CVector(-33.443, 0, -5.320), Quaternion(0.0000, -0.7880, 0.0000, 0.6157),1 )
			--CreateNewDummyObject( "house2",	"hs03", -1, -1, CVector(GetPlayerVehicle():GetPosition()) + CVector(-28.409, 0, 25.611), Quaternion(0.0000, -0.5682, 0.0000, 0.8229),1 )
			--CreateNewDummyObject( "townhall",	"hs04", -1, -1, CVector(GetPlayerVehicle():GetPosition()) + CVector(30.103, 0, 6.916), Quaternion(0.0000, 0.6820, 0.0000, 0.7314),1 )
			--CreateNewDummyObject( "house3",	"hs05", -1, -1, CVector(GetPlayerVehicle():GetPosition()) + CVector(24.537, 0, 17.672), Quaternion(0.0000, 0.6478, 0.0000, 0.7618),1 )
			--CreateNewDummyObject( "house2",	"hs06", -1, -1, CVector(GetPlayerVehicle():GetPosition()) + CVector(26.281, 0, -5.823), Quaternion(0.0000, 0.0000, 0.0000, 1.0000),1 )
			--CreateNewDummyObject( "house3",	"hs07", -1, -1, CVector(GetPlayerVehicle():GetPosition()) + CVector(-27.398, 0, -23.166), Quaternion(0.0000, 0.928, 0.0000, -0.3726),1 )

			for a = 1, 7 do
				CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(getPos('hs0'..a)), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)
			end
			
			GetPlayerVehicle():SetPosition(CVector(GetPlayerVehicle():GetPosition() + CVector(0, 10, 0)))
			CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(GetPlayerVehicle():GetPosition()), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)

			trigger:Deactivate()    
		</script>
	</trigger>

	<trigger Name="tr_CreateArtefact4Pyotr" active="0">
		<event 	timeout="0.2" eventid="GE_TIME_PERIOD" />
		<script>
			TeamCreate("PyotrTeam", 1071, CVector(GetPlayerVehicle():GetPosition()) + CVector(random(40,60), 1, random(40,60)), {"Bug01"})
			if GetEntityByName("PyotrPoint4") ~= nil then
				GetEntityByName("PyotrTeam_vehicle_0"):SetSkin(2)
			else
				GetEntityByName("PyotrTeam_vehicle_0"):SetSkin(0)
			end
			--GetEntityByName("PyotrTeam_vehicle_0"):SetRotation(Quaternion(GetPlayerVehicle():GetRotation()) + Quaternion(-1, 0, 0, 1))

			TActivate('tr_CheckPyotrDie')
			trigger:Deactivate()    
		</script>
	</trigger>

	<trigger Name="tr_CheckPyotrDie" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="PyotrTeam" />
		<script>
			if GetEntityByName("PyotrTeam") ~= nil then
				GetEntityByName("PyotrTeam"):Remove()
			end

			AllowSave( true )

			if GetEntityByName('hs00') then GetEntityByName('hs00'):Remove() end
			--for a = 1, 7 do
			--	CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(GetEntityByName('hs0'..a):GetPosition()), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)
			--	if GetEntityByName('hs0'..a) then GetEntityByName('hs0'..a):Remove() end
			--end

			if GetEntityByName("PyotrPoint4") ~= nil then
				CreateNewSgNodeObject( "point", "PyotrPoint5", -1, -1, CVector(GetPlayerVehicle():GetPosition()), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				TActivate('tr_Artefact4BossPyotrStart')
			elseif GetEntityByName("PyotrPoint3") ~= nil then
				CreateNewSgNodeObject( "point", "PyotrPoint4", -1, -1, CVector(GetPlayerVehicle():GetPosition()), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			elseif GetEntityByName("PyotrPoint2") ~= nil then
				CreateNewSgNodeObject( "point", "PyotrPoint3", -1, -1, CVector(GetPlayerVehicle():GetPosition()), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			elseif GetEntityByName("PyotrPoint1") ~= nil then
				CreateNewSgNodeObject( "point", "PyotrPoint2", -1, -1, CVector(GetPlayerVehicle():GetPosition()), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			else
            	AddFadingMsgId( "fm_history_got" )
				AddHistory( "stranded_a3_1" )
				CreateNewSgNodeObject( "point", "PyotrPoint1", -1, -1, CVector(GetPlayerVehicle():GetPosition()), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			end

			trigger:Deactivate() 
		</script>
	</trigger>

	<trigger Name="tr_BossTeleport" active="0">
		<event 	timeout="10" eventid="GE_TIME_PERIOD" />
		<script>
			if GetPlayerVehicle() and GetEntityByName("PyotrTeam") then
				r = random(1,9)
				GetPlayerVehicle():SetPosition(CVector(getPos("Artefact4Loc"..r)) + CVector(0, 3, 0))
				CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(GetPlayerVehicle():GetPosition()), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)
			else
				trigger:Deactivate()
			end
		</script>
	</trigger>

	<trigger Name="tr_CheckPyotrTankDie" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="PyotrTeam" />
		<script>
			if GetEntityByName("PyotrTeam") ~= nil then
				GetEntityByName("PyotrTeam"):Remove()
			end

			if GetEntityByName("hs00") ~= nil then
				GetEntityByName("hs00"):Remove()
			end

			AllowSave( true )

            AddFadingMsgId( "fm_history_got" )
			AddHistory( "stranded_a3_2" )

			CompleteQuest('Stranded_ArtefactQuest_3')
			CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(GetPlayerVehicle():GetPosition()), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)
			AddQuestItem('quest_artefact4')
			AddFadingMsgByStrIdFormatted( "fm_player_add_thing", "quest_artefact4")

			StopPlayingCustomMusic()
			TDeactivate('tr_BossTeleport')
			trigger:Deactivate() 
		</script>
	</trigger>

	<trigger Name="tr_Artefact5Create" active="0">
		<event 	timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			CreateNewSgNodeObject( "ET_PS_LENS_S9", "art5_lens", -1, -1, CVector(getPos("Artefact5Loc")) + CVector(0, 4, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			CreateNewDummyObject( "stranded_artefact5",	"art5_dummy", -1, -1, CVector(getPos("Artefact5Loc")) + CVector(0, 4, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="tr_Artefact5" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="Artefact5Loc" />
		<script>
			CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(GetEntityByName("art5_dummy"):GetPosition()), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)
			if GetEntityByName("art5_lens") then GetEntityByName("art5_lens"):Remove() end
			if GetEntityByName("art5_dummy") then GetEntityByName("art5_dummy"):Remove() end
			AddQuestItem("quest_artefact5")
            AddFadingMsgId( "fm_history_got" )
			AddHistory( "stranded_7" )
			AddFadingMsgByStrIdFormatted( "fm_player_add_thing", "quest_artefact5")
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="tr_EndGame" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="EndLoc" />
		<script>
			CompleteQuest("Stranded_End_Quest")
			TActivate("EndCin1")
			trigger:Deactivate()
		</script>
	</trigger>

<!-- Technical stuff to the end -->

	<!-- World creation -->

	<trigger Name="CreateHealingStationLevelZero" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			--CreateNewDummyObject( "model", "name", -1, -1, pos, rot,1 )
			CreateNewDummyObject( "ruins1", "hp_ruins", -1, -1, CVector(4694.273, 319.690, 5368.269), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			--CreateNewSgNodeObject( "ET_PS_BOSS1_SMOKE", "hp_smoke", -1, -1, CVector(getPos("UpgradeHealLoc")) - CVector(0, 1, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			CreateNewSgNodeObject( "ET_PS_LENS_D1", "hp_lens", -1, -1, CVector(getPos("UpgradeHealLoc")) + CVector(0, 2, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			CreateNewSgNodeObject( "ET_PS_LENS_D1", "hp2_lens", -1, -1, CVector(getPos("PetrolStationTown_enter")) + CVector(0, 2, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="CreateFuelingStationLevelZero" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			CreateNewDummyObject( "concrete_ruins1", "fuel_ruins1", -1, -1, CVector(4656.261, 320.073, 5283.396), Quaternion(0.0000, 0.0610, 0.0000, -0.9981), 1 )
			CreateNewDummyObject( "ruins1", "fuel_ruins2", -1, -1, CVector(4646.794, 320.073, 5297.360), Quaternion(0.0000, 0.9998, 0.0000, 0.0196), 1 )
			CreateNewDummyObject( "concrete_ruins4", "fuel_ruins3", -1, -1, CVector(4636.566, 320.073, 5298.681), Quaternion(0.0000, 0.6772, 0.0000, -0.7358), 1 )
			CreateNewDummyObject( "ruins7", "petrol_station_ruins", -1, -1, CVector(4537.753, 318.002, 5256.401), Quaternion(0.0000, -0.6915, 0.0000, 0.7224), 1 )
			--CreateNewSgNodeObject( "ET_PS_BOSS1_SMOKE", "fuel_smoke", -1, -1, CVector(getPos("UpgradeFuelLoc") - CVector(0, 1, 0)), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			CreateNewSgNodeObject( "ET_PS_LENS_D1", "fuel_lens", -1, -1, CVector(getPos("UpgradeFuelLoc")) + CVector(0, 2, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="CreateWarehouse" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			CreateNewSgNodeObject( "ET_PS_BOSS1_SMOKE", "ware_smoke", -1, -1, CVector(getPos("WarehouseLoc")) - CVector(0, 1, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			CreateNewSgNodeObject( "ET_PS_LENS_D4", "ware_lens", -1, -1, CVector(getPos("WarehouseLoc")), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="CreateStationsIndicators" active="0">
		<event timeout="0" eventid="GE_TIME_PERIOD" />
		<script>
			CreateNewSgNodeObject( "ET_PS_BOSS1_SMOKE", "sell_smoke", -1, -1, CVector(getPos("SellLoc")) - CVector(0, 1, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			CreateNewSgNodeObject( "ET_PS_LENS_D4", "sell_lens", -1, -1, CVector(getPos("SellLoc")), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			CreateNewSgNodeObject( "ET_PS_BOSS1_SMOKE", "hp1_smoke", -1, -1, CVector(getPos("HealLoc")) - CVector(0, 1, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			CreateNewSgNodeObject( "ET_PS_LENS_S9", "hp1_lens", -1, -1, CVector(getPos("HealLoc")), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			CreateNewSgNodeObject( "ET_PS_BOSS1_SMOKE", "fuel1_smoke", -1, -1, CVector(getPos("FuelLoc")) - CVector(0, 1, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			CreateNewSgNodeObject( "ET_PS_LENS_D5", "fuel1_lens", -1, -1, CVector(getPos("FuelLoc")), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			trigger:Deactivate()
		</script>
	</trigger>

	<!-- Healing upgrade -->

	<trigger Name="trUpgradeHealingStation1" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="UpgradeHealLoc" />
		<script>
			local Plf = GetPlayerVehicle()
			Plf:SetThrottle( 0 )
			Plf:SetCustomLinearVelocity( 0 )

			if Plf:HasAmountOfItemsInRepository("machinery", 1) and GetPlayerMoney() >= 5000 then
				c = SpawnMessageBox("8804")
				if c == 1 then
					Plf:RemoveItemsFromRepository("machinery", 1)
					AddPlayerMoney(-5000)

					local r1 = GetEntityByName ("hp_ruins")
					if r1 then r1:Remove() end

					CreateNewDummyObject( "petrolhouse1", "hp_building1", -1, -1, CVector(4694.273, 319.690, 5368.269), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
					CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(4694.273, 319.690, 5368.269), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)
					
					local hl1 = GetEntityByName("hp_smoke")
					if hl1 then hl1:Remove() end
					local hl2 = GetEntityByName("hp_lens")
					if hl2 then hl2:Remove() end

					trigger:Deactivate()
				end
			else
				c = SpawnMessageBox("8805")
			end
		</script>
	</trigger>
	
	<trigger Name="trUpgradeHealingStation2" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="PetrolStationTown_enter" />
		<script>
			local Plf = GetPlayerVehicle()
			Plf:SetThrottle( 0 )
			Plf:SetCustomLinearVelocity( 0 )

			if Plf:HasAmountOfItemsInRepository("electronics", 1) and GetPlayerMoney() >= 15000 and GetEntityByName("fuel_building3") ~= nil and GetEntityByName("hp_building1") ~= nil then
				c = SpawnMessageBox("9804")
				if c == 1 then
					Plf:RemoveItemsFromRepository("electronics", 1)
					AddPlayerMoney(-15000)

					local r4 = GetEntityByName ("petrol_station_ruins")
					if r4 then r4:Remove() end
					
					local hl2 = GetEntityByName("hp2_lens")
					if hl2 then hl2:Remove() end

					CreateNewDummyObject( "petrolhouse2", "hp_building2", -1, -1, CVector(4524.060, 319.411, 5264.049), Quaternion(0.017, 0.714, 0.024, 0.699), 1 )

					CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(4524.060, 319.611, 5264.049), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)
					CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(4537.753, 318.002, 5256.401), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)
					
					local town = GetEntityByName("PetrolStationTown")
					if town then
						town:SetRuined( false )
						town:SetOpenGateToPlayer( true )
					end

					local workshop = GetEntityByName("PetrolStationTown_Workshop")
					local cars = workshop:GetRepositoryByTypename("Vehicles")
					local repository = workshop:GetRepositoryByTypename("CabinsAndBaskets")
					cars:AddItems("TornadoForSale", 1)
					repository:AddItems("TornadoCab02", 1)
					repository:AddItems("TornadoCab03", 1)
					repository:AddItems("TornadoCargo02", 1)
					repository:AddItems("TornadoCargo03", 1)

					trigger:Deactivate()
				end
			else
				c = SpawnMessageBox("9805")
			end
		</script>
	</trigger>

	<!-- Fueling upgrade -->

	<trigger Name="trUpgradeFuelingStation1" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="UpgradeFuelLoc" />
		<script>
			local Plf = GetPlayerVehicle()
			Plf:SetThrottle( 0 )
			Plf:SetCustomLinearVelocity( 0 )

			if Plf:HasAmountOfItemsInRepository("fuel", 1) and GetPlayerMoney() >= 10000 then
				c = SpawnMessageBox("9904")
				if c == 1 then
					Plf:RemoveItemsFromRepository("fuel", 1)
					AddPlayerMoney(-10000)

					local r1 = GetEntityByName ("fuel_ruins1")
					if r1 then r1:Remove() end
					local r2 = GetEntityByName ("fuel_ruins2")
					if r2 then r2:Remove() end
					local r3 = GetEntityByName("fuel_ruins3")
					if r3 then r3:Remove() end
					local fl1 = GetEntityByName("fuel_smoke")
					if fl1 then fl1:Remove() end
					local fl2 = GetEntityByName("fuel_lens")
					if fl2 then fl2:Remove() end

					CreateNewDummyObject( "petrolhouse2", "fuel_building1", -1, -1, CVector(4656.261, 320.073, 5283.396), Quaternion(0.0000, 0.0610, 0.0000, -0.9981), 1 )
					CreateNewDummyObject( "petrolhouse3", "fuel_building2", -1, -1, CVector(4646.794, 320.073, 5297.360), Quaternion(0.0000, 0.9998, 0.0000, 0.0196), 1 )
					CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(4656.261, 320.073, 5283.396), Quaternion(0.0000, 0.0610, 0.0000, -0.9981), 10000)
					CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(4646.794, 320.073, 5297.360), Quaternion(0.0000, 0.9998, 0.0000, 0.0196), 10000)
					CreateNewDummyObject( "petrolhouse2", "fuel_building3", -1, -1, CVector(4635.166, 320.073, 5298.681), Quaternion(0.0000, 0.6772, 0.0000, -0.7358), 1 )
					CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(4635.166, 320.073, 5298.681), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)
					trigger:Deactivate()
				end
			else
				c = SpawnMessageBox("8905")
			end
		</script>
	</trigger>

	<!-- Selling upgrade -->
<!-- 
	<trigger Name="trUpgradeSellingStation1" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="UpgradeSellLoc" />
		<script>
			local Plf = GetPlayerVehicle()
			Plf:SetThrottle( 0 )
			Plf:SetCustomLinearVelocity( 0 )

			if Plf:HasAmountOfItemsInRepository("specter01", 1) and Plf:HasAmountOfItemsInRepository("kord01", 1) and Plf:HasAmountOfItemsInRepository("flag01", 1) then
				c = SpawnMessageBox("10004")
				if c == 1 then
					Plf:RemoveItemsFromRepository("specter01", 1)
					Plf:RemoveItemsFromRepository("kord01", 1)
					Plf:RemoveItemsFromRepository("flag01", 1)

					CreateNewDummyObject( "iron_dot", "sell_up1", -1, -1, CVector(4665.201, 319.760, 5365.045), Quaternion(0.0000, -0.6756, 0.0000, -0.7373), 1 )
					CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(4665.201, 319.760, 5365.045), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)
					TActivate("trUpgradeSellingStation2")
					trigger:Deactivate()
				end
			else
				c = SpawnMessageBox("10005")
			end
		</script>
	</trigger>
	
	<trigger Name="trUpgradeSellingStation2" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="UpgradeSellLoc" />
		<script>
			local Plf = GetPlayerVehicle()
			Plf:SetThrottle( 0 )
			Plf:SetCustomLinearVelocity( 0 )

			if Plf:HasAmountOfItemsInRepository("maxim01", 1) and Plf:HasAmountOfItemsInRepository("fagot01", 1) then
				c = SpawnMessageBox("11004")
				if c == 1 then
					Plf:RemoveItemsFromRepository("maxim01", 1)
					Plf:RemoveItemsFromRepository("fagot01", 1)

					local sl1 = GetEntityByName("sell_smoke")
					if sl1 then sl1:Remove() end
					local sl2 = GetEntityByName("sell_lens")
					if sl2 then sl2:Remove() end

					CreateNewDummyObject( "iron_wall", "sell_up2", -1, -1, CVector(4667.704, 320.026, 5369.564), Quaternion(-0.0105, 0.7134, 0.0417, 0.6995), 1 )
					CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(4667.704, 320.026, 5369.564), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)

					trigger:Deactivate()
				end
			else
				c = SpawnMessageBox("11005")
			end
		</script>
	</trigger> -->

	<!-- BeachBoxSystem trademark -->

	<trigger Name="trSpawnBoxes" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc1" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc2" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc3" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc4" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc5" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc6" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc7" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc8" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc9" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc10" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc11" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc12" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc13" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc14" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc15" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc17" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc18" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc19" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc20" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc21" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc22" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc23" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc24" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc25" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc26" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc27" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc28" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc29" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc30" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc31" />
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="XLoc32" />
		<script>
			if IsQuestTaken('Stranded_ArtefactQuest_3') and not(IsQuestComplete('Stranded_ArtefactQuest_3')) and (GetEntityByName('ArenaStar10') or IsQuestComplete('Stranded_ArtefactQuest_2')) and not(GetEntityByName('hs00')) and not (GetEntityByName("PyotrPoint5") ~= nil) then
				if (random(10) == 3) then
					TActivate('tr_Artefact4')
				end
			end
			
			if (random(3) == 1) then
				local i = random(1, 64)
				local goods_list = {"potato", "scrap_metal", "firewood", "surfboard", "machinery", "oil", "fuel", "book", "tobacco", "electronics"}
				local len = getn(goods_list)

				local name = "ItemsChest"..random(10000)
				
				local chestID = CreateNewObject{	prototypeName = "someChest",
													objName = name
												}	
			
				local MyChest = GetEntityByID(chestID)

				if MyChest == nil then
					println("TRIGGER ERROR: Can't create box ")
					return nil
				end
					
				MyChest:SetPosition(CVector(getPos("YLoc"..i)))

				good_prot = goods_list[random(len)]
				local id = CreateNewObject{ prototypeName = good_prot, objName = "RandomStuff"..random(10000), belong = 1100 }
				local good = GetEntityByID( id )
				MyChest:AddChild(good)
				
				println("Spawned "..good_prot.." on "..i)
				AddFadingMsgByStrIdFormatted("fm_good_spawned", good_prot)
			end
		</script>
	</trigger>

	<!-- Technical stuff -->

	<trigger Name="RemoveNilsFromCont" active="0">
	<event timeout="0.1" eventid="GE_TIME_PERIOD" />
	<script>	
		for i = 1, 10000 do
			if (GetEntityByName("RandomStuff"..i) and (GetEntityByName("RandomStuff"..i):GetParent() == nil)) then
				GetEntityByName("RandomStuff"..i):Remove()
			end
		end
		trigger:Deactivate()
	</script>
</trigger>

	<!-- Selling -->

	<trigger Name="trSelling" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="SellLoc" />
		<script>
			local goods_list = {"potato", "scrap_metal", "firewood", "surfboard", "bottle", "machinery", "oil", "fuel", "book", "tobacco", "electronics"}

			local Plf = GetPlayerVehicle()
			Plf:SetThrottle( 0 )
			Plf:SetCustomLinearVelocity( 0 )

			local sum = 0
			for i = 1,getn(goods_list) do
				local a = 1
				while a == 1 do
					a = GetPlayerVehicle():HasAmountOfItemsInRepository(goods_list[i], 1)
					if a == 1 then
						sum = sum + 1
						break
					end
				end
			end
			if sum > 0 then
				local c = SpawnMessageBox( "8802" )
				if c == 1 then
					sum = 0
					for i = 1,getn(goods_list) do
						local a = 1
						local b = 1
						while a == 1 do
							a = GetPlayerVehicle():HasAmountOfItemsInRepository(goods_list[i], b)
							if a == 1 then
								b = b + 1
								--println("a = "..a.." and b = "..b)
							end
						end
						--println((b - 1).."*"..i.."*50".."="..((b * i) * 50))
						sum = sum + (((b - 1) * i) * 100) + random(50,75)
						GetPlayerVehicle():RemoveItemsFromRepository(goods_list[i], b - 1)
					end
					AddPlayerMoney(sum)
					if g_ObjCont:size() > 1000 then
						TActivate("RemoveNilsFromCont")
					end
				end
			else
				local c = SpawnMessageBox( "8803" )
			end
		</script>
	</trigger>

	<!-- <trigger Name="trSelling" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="SellLoc" />
		<script>
			local goods_list = {"potato", "scrap_metal", "firewood", "bottle", "machinery", "oil", "fuel", "book", "tobacco", "electronics"}
			local weapons_list = {"hornet01", "specter01", "pkt01", "kord01", "storm01", "vector01", "vulcan01", "kpvt01", "flag01", "rainmetal01"}
			local energy_list = {"maxim01", "fagot01", "hunterSideGun", "odin01", "mrakSideGun"}

			local all_list  = {"potato", "scrap_metal", "firewood", "bottle", "machinery", "oil", "fuel", "book", "tobacco", "electronics", "hornet01", "specter01", "pkt01", "kord01", "storm01", "vector01", "vulcan01", "kpvt01", "flag01", "rainmetal01", "maxim01", "fagot01", "hunterSideGun", "odin01", "mrakSideGun"}
			local all_len = getn(all_list)

			local lens = {getn(goods_list), getn(weapons_list), getn(energy_list)}
			local cost_coeffs = {50, 150, 1000}
			local upgrade_level = 3

			if GetEntityByName("sell_up1") == nil then
				all_len = getn(goods_list)
				upgrade_level = 1
			elseif GetEntityByName("sell_up2") == nil then
				all_len = getn(goods_list) + getn(weapons_list)
				upgrade_level = 2
			end

			local Plf = GetPlayerVehicle()
			Plf:SetThrottle( 0 )
			Plf:SetCustomLinearVelocity( 0 )

			local sum = 0
			for i = 1,all_len do
				local a = 1
				while a == 1 do
					a = GetPlayerVehicle():HasAmountOfItemsInRepository(all_list[i], 1)
					if a == 1 then
						sum = sum + 1
						break
					end
				end
			end
			if sum > 0 then
				local c = SpawnMessageBox( "8802" )
				if c == 1 then
					sum = 0
					for i = 1,upgrade_level do
						local cur_list = {}
						if i == 1 then 
							cur_list = goods_list
						elseif i == 2 then 
							cur_list = weapons_list
						else 
							cur_list = energy_list
						end
						for j = 1,lens[i] do
							local a = 1
							local b = 1
							while a == 1 do
								a = GetPlayerVehicle():HasAmountOfItemsInRepository(cur_list[j], b)
								if a == 1 then
									b = b + 1
									println("a = "..a.." and b = "..b)
								end
							end
							sum = sum + (((b - 1) * j) * cost_coeffs[i])
							GetPlayerVehicle():RemoveItemsFromRepository(cur_list[j], b - 1)
						end
					end
					AddPlayerMoney(sum)
					TActivate("RemoveNilsFromCont")
				end
			else
				local c = SpawnMessageBox( "8803" )
			end
		</script>
	</trigger> -->

	<!-- Warehouse -->

	<trigger Name="trWarehouse" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="WarehouseLoc" />
		<script>
			local weapon_list = {"hornet01"}
			-- local goods_list = {"surfboard", "fuel", "machinery"}
			local goods_list = {"surfboard"}

			local Plf = GetPlayerVehicle()
			Plf:SetThrottle( 0 )
			Plf:SetCustomLinearVelocity( 0 )

			local sum = 0
			for i = 1,getn(weapon_list) do
				local a = 1
				while a == 1 do
					a = GetPlayerVehicle():HasAmountOfItemsInRepository(weapon_list[i], sum + 1)
					if a == 1 then
						sum = sum + 1
					end
				end
			end
			if sum >= 2 then
				local c = SpawnMessageBox( "88021" )
				if c == 1 then
					for i = 1,getn(weapon_list) do
						local a = 1
						while a == 1 do
							a = GetPlayerVehicle():HasAmountOfItemsInRepository(weapon_list[i], 2)
							if a == 1 then
								GetPlayerVehicle():RemoveItemsFromRepository(weapon_list[i], 2)
								local good_prot = goods_list[random(getn(goods_list))]
								GetPlayerVehicle():AddItemsToRepository(good_prot, 1)
								AddFadingMsgByStrIdFormatted("fm_good_added", good_prot)
							end
						end
					end
				end
			elseif sum == 0 then
				local c = SpawnMessageBox( "88031" )
			else
				local c = SpawnMessageBox( "88032" )
			end
		</script>
	</trigger>

	<!-- Healing -->

	<trigger Name="trHealing" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="HealLoc" />
		<script>
			if  GetPlayerMoney() >= 5 then
				TActivate("trHealingGo")
				TActivate("trHealingMsg")
				AllowSave(false)
			else
				AddImportantFadingMsgId( "fm_hp_no_money" )
			end
		</script>
	</trigger>

	<trigger Name="trHealingMsg" active="0">
		<event timeout="1" eventid="GE_TIME_PERIOD" />
		<script>
			AddImportantFadingMsgId( "fm_hp" )
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trHealingGo" active="0">
		<event timeout="2" eventid="GE_TIME_PERIOD" />
		<script>
			local coeff = 0.6
			local hp_plus = "+ 25"
			cost = 10
			if GetEntityByName("hp_building1") ~= nil then
				coeff = 1
				hp_plus = "+ 50"
				cost = 25
			end
			if GetPlayerMoney() >= cost then
				if (GetPlayerVehicle():GetMaxHealth() * coeff - 10) > GetPlayerVehicle():GetHealth() then
					AddPlayerMoney(-cost)
					GetPlayerVehicle():AddModifier("hp", hp_plus)
				else
					if GetEntityByName("hp_building1") ~= nil then
						AddImportantFadingMsgId( "fm_hp_end" )
						GetPlayerVehicle():AddModifier("hp", "= "..tostring(GetPlayerVehicle():GetMaxHealth() * coeff))
					else
						AddImportantFadingMsgId( "fm_hp_enough" )
						GetPlayerVehicle():AddModifier("hp", "= "..tostring(GetPlayerVehicle():GetMaxHealth() * coeff))
					end
					trigger:Deactivate()
				end
			else
				AddImportantFadingMsgId( "fm_hp_no_money" )
				trigger:Deactivate()
			end
		</script>
	</trigger>

	<trigger Name="trHealingEnd" active="1">
		<event eventid="GE_OBJECT_LEAVES_LOCATION" ObjName="HealLoc" />
		<script>
			TDeactivate("trHealingGo")
			--AddImportantFadingMsgId( "fm_hp_end" )
			AllowSave(true)
		</script>
	</trigger>

	<!-- Fueling -->

	<trigger Name="trFueling" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="FuelLoc" />
		<script>
			if  GetPlayerMoney() >= 10 then
				TActivate("trFuelingGo")
				TActivate("trFuelingMsg")
				AllowSave(false)
			else
				AddImportantFadingMsgId( "fm_fueling_no_money" )
			end
		</script>
	</trigger>

	<trigger Name="trFuelingMsg" active="0">
		<event timeout="1" eventid="GE_TIME_PERIOD" />
		<script>
			AddImportantFadingMsgId( "fm_fueling" )
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trFuelingGo" active="0">
		<event timeout="2" eventid="GE_TIME_PERIOD" />
		<script>
			local coeff = 0.6
			local fuel_plus = "+ 5"
			local cost = 10
			if GetEntityByName("fuel_building3") ~= nil then
				coeff = 1
				fuel_plus = "+ 20"
				cost = 30
			end
			if GetPlayerMoney() >= cost then
				if (GetPlayerVehicle():GetMaxFuel() * coeff - 5) > GetPlayerVehicle():GetFuel() then
					AddPlayerMoney(-cost)
					GetPlayerVehicle():AddModifier("fuel", fuel_plus)
				else
					if GetEntityByName("fuel_building3") ~= nil then
						AddImportantFadingMsgId( "fm_fueling_end" )
						GetPlayerVehicle():AddModifier("fuel", "= "..tostring(GetPlayerVehicle():GetMaxFuel() * coeff))
					else
						AddImportantFadingMsgId( "fm_fueling_enough" )
						GetPlayerVehicle():AddModifier("fuel", "= "..tostring(GetPlayerVehicle():GetMaxFuel() * coeff))
					end
					trigger:Deactivate()
				end
			else
				AddImportantFadingMsgId( "fm_fueling_no_money" )
				trigger:Deactivate()
			end
		</script>
	</trigger>

	<trigger Name="trFuelingEnd" active="1">
		<event eventid="GE_OBJECT_LEAVES_LOCATION" ObjName="FuelLoc" />
		<script>
			TDeactivate("trFuelingGo")
			--AddImportantFadingMsgId( "fm_fueling_end" )
			AllowSave(true)
		</script>
	</trigger>

	<!-- Arena -->

	<trigger Name="CreateArena" active="0">
		<event timeout="0.5" eventid="GE_TIME_PERIOD" />
		<script>
			CreateNewSgNodeObject( "ET_PS_BOSS1_SMOKE", "arena_smoke", -1, -1, CVector(getPos("ArenaLoc")) - CVector(0, 1, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			CreateNewSgNodeObject( "ET_PS_LENS_D4", "arena_lens", -1, -1, CVector(getPos("ArenaLoc")), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="RemoveArena" active="0">
		<event timeout="0.5" eventid="GE_TIME_PERIOD" />
		<script>
			local ar1 = GetEntityByName("arena_smoke")
			if ar1 then ar1:Remove() end
			local ar2 = GetEntityByName("arena_lens")
			if ar2 then ar2:Remove() end
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="CreateBarricades" active="0">
		<event timeout="0.5" eventid="GE_TIME_PERIOD" />
		<script>					
			CreateNewDummyObject( "arena_barricade15", "barr1", -1, -1, CVector(5163.769, 307.830, 4714.423), Quaternion(-0.0209, 0.5642, -0.0306, 0.8248), 1 )
			CreateNewDummyObject( "arena_barricade15", "barr2", -1, -1, CVector(5152.715, 307.550, 4709.985), Quaternion(0.0000, 0.5057, 0.0000, 0.8627), 1 )
			CreateNewDummyObject( "arena_barricade15", "barr3", -1, -1, CVector(5158.177, 307.710, 4712.417), Quaternion(0.0000, 0.5592, 0.0000, 0.8290), 1 )
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="RemoveBarricades" active="0">
		<event timeout="0.5" eventid="GE_TIME_PERIOD" />
		<script>
			local aa = GetEntityByName("barr1")
			if aa then aa:Remove() end
			local bb = GetEntityByName("barr2")
			if bb then bb:Remove() end
			local cc = GetEntityByName("barr3")
			if cc then cc:Remove() end
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trArena" active="1">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="ArenaLoc" />
		<script>
			if GetPlayerVehicle():HasAmountOfItemsInRepository("surfboard", 1) then
				GetPlayerVehicle():RemoveItemsFromRepository("surfboard", 1)

				AllowSave( false )

				CreateEffectTTLed( "ET_LS_LIGHT_RED", CVector(GetPlayerVehicle():GetPosition()), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 2000)

				TActivate("StartArena")
				trigger:Deactivate()
			else
				AddImportantFadingMsgId("fm_arena_no_surfboard")
			end
		</script>
	</trigger>

	<trigger Name="StartArena" active="0">
		<event timeout="2.0" eventid="GE_TIME_PERIOD" />
		<script>
			if GetEntityByName("ArenaStar19") ~= nil then
				AddImportantFadingMsgByStrIdFormatted("fm_arena_enemy_number", 20)
				TeamCreate("ArenaTeam", 1071, CVector(5163.478, 305.604, 4555.910), {"ArenaCar20"})
				GetEntityByName("ArenaTeam_vehicle_0"):SetSkin(8)
			elseif GetEntityByName("ArenaStar18") ~= nil then
				AddImportantFadingMsgByStrIdFormatted("fm_arena_enemy_number", 19)
				TeamCreate("ArenaTeam", 1071, CVector(5163.478, 305.604, 4555.910), {"ArenaCar19"})
				GetEntityByName("ArenaTeam_vehicle_0"):SetSkin(8)
			elseif GetEntityByName("ArenaStar17") ~= nil then
				AddImportantFadingMsgByStrIdFormatted("fm_arena_enemy_number", 18)
				TeamCreate("ArenaTeam", 1071, CVector(5163.478, 305.604, 4555.910), {"ArenaCar18"})
				GetEntityByName("ArenaTeam_vehicle_0"):SetSkin(5)
			elseif GetEntityByName("ArenaStar16") ~= nil then
				AddImportantFadingMsgByStrIdFormatted("fm_arena_enemy_number", 17)
				TeamCreate("ArenaTeam", 1071, CVector(5163.478, 305.604, 4555.910), {"ArenaCar17"})
				GetEntityByName("ArenaTeam_vehicle_0"):SetSkin(2)
			elseif GetEntityByName("ArenaStar15") ~= nil then
				AddImportantFadingMsgByStrIdFormatted("fm_arena_enemy_number", 16)
				TeamCreate("ArenaTeam", 1071, CVector(5163.478, 305.604, 4555.910), {"ArenaCar16"})
				GetEntityByName("ArenaTeam_vehicle_0"):SetSkin(3)
			elseif GetEntityByName("ArenaStar14") ~= nil then
				AddImportantFadingMsgByStrIdFormatted("fm_arena_enemy_number", 15)
				TeamCreate("ArenaTeam", 1071, CVector(5163.478, 305.604, 4555.910), {"ArenaCar15"})
				GetEntityByName("ArenaTeam_vehicle_0"):SetSkin(4)
			elseif GetEntityByName("ArenaStar13") ~= nil then
				AddImportantFadingMsgByStrIdFormatted("fm_arena_enemy_number", 14)
				TeamCreate("ArenaTeam", 1071, CVector(5163.478, 305.604, 4555.910), {"ArenaCar14"})
				GetEntityByName("ArenaTeam_vehicle_0"):SetSkin(2)
			elseif GetEntityByName("ArenaStar12") ~= nil then
				AddImportantFadingMsgByStrIdFormatted("fm_arena_enemy_number", 13)
				TeamCreate("ArenaTeam", 1071, CVector(5163.478, 305.604, 4555.910), {"ArenaCar13"})
				GetEntityByName("ArenaTeam_vehicle_0"):SetSkin(1)
			elseif GetEntityByName("ArenaStar11") ~= nil then
				AddImportantFadingMsgByStrIdFormatted("fm_arena_enemy_number", 12)
				TeamCreate("ArenaTeam", 1071, CVector(5163.478, 305.604, 4555.910), {"ArenaCar12"})
				GetEntityByName("ArenaTeam_vehicle_0"):SetSkin(6)
			elseif GetEntityByName("ArenaStar10") ~= nil then
				AddImportantFadingMsgByStrIdFormatted("fm_arena_enemy_number", 11)
				TeamCreate("ArenaTeam", 1071, CVector(5163.478, 305.604, 4555.910), {"ArenaCar11"})
				GetEntityByName("ArenaTeam_vehicle_0"):SetSkin(7)
			elseif GetEntityByName("ArenaStar9") ~= nil then
				AddImportantFadingMsgByStrIdFormatted("fm_arena_enemy_number", 10)
				TeamCreate("ArenaTeam", 1071, CVector(5163.478, 305.604, 4555.910), {"ArenaCar10"})
				GetEntityByName("ArenaTeam_vehicle_0"):SetSkin(5)
			elseif GetEntityByName("ArenaStar8") ~= nil then
				AddImportantFadingMsgByStrIdFormatted("fm_arena_enemy_number", 9)
				TeamCreate("ArenaTeam", 1071, CVector(5163.478, 305.604, 4555.910), {"ArenaCar9"})
				GetEntityByName("ArenaTeam_vehicle_0"):SetSkin(4)
			elseif GetEntityByName("ArenaStar7") ~= nil then
				AddImportantFadingMsgByStrIdFormatted("fm_arena_enemy_number", 8)
				TeamCreate("ArenaTeam", 1071, CVector(5163.478, 305.604, 4555.910), {"ArenaCar8"})
				GetEntityByName("ArenaTeam_vehicle_0"):SetSkin(1)
			elseif GetEntityByName("ArenaStar6") ~= nil then
				AddImportantFadingMsgByStrIdFormatted("fm_arena_enemy_number", 7)
				TeamCreate("ArenaTeam", 1071, CVector(5163.478, 305.604, 4555.910), {"ArenaCar7"})
				GetEntityByName("ArenaTeam_vehicle_0"):SetSkin(3)
			elseif GetEntityByName("ArenaStar5") ~= nil then
				AddImportantFadingMsgByStrIdFormatted("fm_arena_enemy_number", 6)
				TeamCreate("ArenaTeam", 1071, CVector(5163.478, 305.604, 4555.910), {"ArenaCar6"})
				GetEntityByName("ArenaTeam_vehicle_0"):SetSkin(2)
			elseif GetEntityByName("ArenaStar4") ~= nil then
				AddImportantFadingMsgByStrIdFormatted("fm_arena_enemy_number", 5)
				TeamCreate("ArenaTeam", 1071, CVector(5163.478, 305.604, 4555.910), {"ArenaCar5"})
				GetEntityByName("ArenaTeam_vehicle_0"):SetSkin(8)
			elseif GetEntityByName("ArenaStar3") ~= nil then
				AddImportantFadingMsgByStrIdFormatted("fm_arena_enemy_number", 4)
				TeamCreate("ArenaTeam", 1071, CVector(5163.478, 305.604, 4555.910), {"ArenaCar4"})
				GetEntityByName("ArenaTeam_vehicle_0"):SetSkin(4)
			elseif GetEntityByName("ArenaStar2") ~= nil then
				AddImportantFadingMsgByStrIdFormatted("fm_arena_enemy_number", 3)
				TeamCreate("ArenaTeam", 1071, CVector(5163.478, 305.604, 4555.910), {"ArenaCar3"})
				GetEntityByName("ArenaTeam_vehicle_0"):SetSkin(6)
			elseif GetEntityByName("ArenaStar1") ~= nil then
				AddImportantFadingMsgByStrIdFormatted("fm_arena_enemy_number", 2)
				TeamCreate("ArenaTeam", 1071, CVector(5163.478, 305.604, 4555.910), {"ArenaCar2"})
				GetEntityByName("ArenaTeam_vehicle_0"):SetSkin(4)
			else
				AddImportantFadingMsgByStrIdFormatted("fm_arena_enemy_number", 1)
				TeamCreate("ArenaTeam", 1071, CVector(5163.478, 305.604, 4555.910), {"ArenaCar1"})
				GetEntityByName("ArenaTeam_vehicle_0"):SetSkin(3)
			end

			TActivate("CreateBarricades")
			TActivate("MovePlayerToBattlePosition")
			TActivate("ArenaEnemyDied")
			TActivate("RemoveArena")
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="MovePlayerToBattlePosition" active="0">
		<event timeout="0.01" eventid="GE_TIME_PERIOD" />
		<script>
			local positions = {CVector(5175.615, 307.212, 4660.789), CVector(5124.289, 306.701, 4655.359), CVector(5042.584, 304.743, 4578.437)}
			local rotations = {Quaternion(0.003, -1.000, 0.008, -0.005), Quaternion(0.004, -0.998, 0.005, 0.069), Quaternion(0.015, -0.895, 0.005, -0.445)}
			local r = random(1,3)

			local Plf = GetPlayerVehicle()
			Plf:SetThrottle( 0 )
			Plf:SetCustomLinearVelocity( 0 )
			Plf:SetGamePositionOnGround(positions[r])
			Plf:SetRotation(rotations[r])
			SetCameraBehindPlayerVehicle()
			

			CreateEffectTTLed( "ET_PS_DRONE_EX", GetPlayerVehicle():GetPosition(), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)

			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="ArenaEnemyDied" active="0">
		<event eventid="GE_OBJECT_DIE" ObjName="ArenaTeam" />
		<script>
			if GetEntityByName("ArenaTeam") ~= nil then
				GetEntityByName("ArenaTeam"):Remove()
			end

			AllowSave( true )

			TActivate("trArenaEnd")
			trigger:Deactivate() 
		</script>
	</trigger>

			
	<trigger Name="trArenaEnd" active="0">
		<event timeout="0.5" eventid="GE_TIME_PERIOD" />
		<script>
			local Plf = GetPlayerVehicle()
			local StarCoord = CVector(5125.894, 389.747, 4473.239)
			StarList = {"D1", "D4", "D5", "S9"}

			CreateEffectTTLed( "ET_PS_DRONE_EX", CVector(Plf:GetPosition()), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 10000)
			
			if GetEntityByName("ArenaStar19") ~= nil then
				AddPlayerMoney(5000)
				CompleteQuest("Arena_Quest")
				if IsQuestTaken("Stranded_ArtefactQuest_2") and not(IsQuestComplete("Stranded_ArtefactQuest_2")) then
					TActivate('Artefact3Cin')
				else
					TActivate('trArenaArtefactQuestNotTaken')
				end
				

				CreateNewSgNodeObject( "ET_PS_LENS_"..StarList[random(1, 4)], "ArenaStar20", -1, -1, StarCoord + CVector(0, 190, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				AddFadingMsgByStrIdFormatted("fm_arena_completed_number", 20)
			elseif GetEntityByName("ArenaStar18") ~= nil then
				AddPlayerMoney(4000)
				AddPlayerItemsWithBox("flag01")
				AddFadingMsgByStrIdFormatted("fm_good_added", "flag01")
				CreateNewSgNodeObject( "ET_PS_LENS_"..StarList[random(1, 4)], "ArenaStar19", -1, -1, StarCoord + CVector(0, 180, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				AddFadingMsgByStrIdFormatted("fm_arena_completed_number", 19)
			elseif GetEntityByName("ArenaStar17") ~= nil then
				AddPlayerMoney(3000)
				AddPlayerItemsWithBox("fagot01")
				AddFadingMsgByStrIdFormatted("fm_good_added", "fagot01")
				CreateNewSgNodeObject( "ET_PS_LENS_"..StarList[random(1, 4)], "ArenaStar18", -1, -1, StarCoord + CVector(0, 170, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				AddFadingMsgByStrIdFormatted("fm_arena_completed_number", 18)
			elseif GetEntityByName("ArenaStar16") ~= nil then
				AddPlayerMoney(2500)
				AddPlayerItemsWithBox("vulcan01")
				AddFadingMsgByStrIdFormatted("fm_good_added", "vulcan01")
				CreateNewSgNodeObject( "ET_PS_LENS_"..StarList[random(1, 4)], "ArenaStar17", -1, -1, StarCoord + CVector(0, 160, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				AddFadingMsgByStrIdFormatted("fm_arena_completed_number", 17)
			elseif GetEntityByName("ArenaStar15") ~= nil then
				AddPlayerMoney(2000)
				AddPlayerItemsWithBox("machinery")
				AddFadingMsgByStrIdFormatted("fm_good_added", "machinery")
				AddPlayerItemsWithBox("vector01")
				AddFadingMsgByStrIdFormatted("fm_good_added", "vector01")
				CreateNewSgNodeObject( "ET_PS_LENS_"..StarList[random(1, 4)], "ArenaStar16", -1, -1, StarCoord + CVector(0, 150, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				AddFadingMsgByStrIdFormatted("fm_arena_completed_number", 16)
			elseif GetEntityByName("ArenaStar14") ~= nil then
				AddPlayerMoney(2000)
				AddPlayerItemsWithBox("maxim01", 1)
				AddFadingMsgByStrIdFormatted("fm_good_added", "maxim01")
				CreateNewSgNodeObject( "ET_PS_LENS_"..StarList[random(1, 4)], "ArenaStar15", -1, -1, StarCoord + CVector(0, 140, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				AddFadingMsgByStrIdFormatted("fm_arena_completed_number", 15)

				local workshop = GetEntityByName("PetrolStationTown_Workshop")
				local cars = workshop:GetRepositoryByTypename("Vehicles")
				local repository = workshop:GetRepositoryByTypename("CabinsAndBaskets")
				cars:AddItems("M35ForSale", 1)
				repository:AddItems("M35Cab02", 1)
				repository:AddItems("M35Cab03", 1)
				repository:AddItems("M35Cargo03", 1)
				repository:AddItems("M35Cargo04", 1)

				AddImportantFadingMsgByStrIdFormatted("fm_arena_level15_completed")

			elseif GetEntityByName("ArenaStar13") ~= nil then
				AddPlayerMoney(2000)
				AddPlayerItemsWithBox("oil")
				AddFadingMsgByStrIdFormatted("fm_good_added", "oil")
				AddPlayerItemsWithBox("fuel")
				AddFadingMsgByStrIdFormatted("fm_good_added", "fuel")
				CreateNewSgNodeObject( "ET_PS_LENS_"..StarList[random(1, 4)], "ArenaStar14", -1, -1, StarCoord + CVector(0, 130, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				AddFadingMsgByStrIdFormatted("fm_arena_completed_number", 14)
			elseif GetEntityByName("ArenaStar12") ~= nil then
				AddPlayerMoney(2000)
				AddPlayerItemsWithBox("electronics")
				AddFadingMsgByStrIdFormatted("fm_good_added", "electronics")
				CreateNewSgNodeObject( "ET_PS_LENS_"..StarList[random(1, 4)], "ArenaStar13", -1, -1, StarCoord + CVector(0, 120, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				AddFadingMsgByStrIdFormatted("fm_arena_completed_number", 13)
			elseif GetEntityByName("ArenaStar11") ~= nil then
				AddPlayerMoney(2000)
				AddPlayerItemsWithBox("tobacco")
				AddFadingMsgByStrIdFormatted("fm_good_added", "tobacco")
				CreateNewSgNodeObject( "ET_PS_LENS_"..StarList[random(1, 4)], "ArenaStar12", -1, -1, StarCoord + CVector(0, 110, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				AddFadingMsgByStrIdFormatted("fm_arena_completed_number", 12)
			elseif GetEntityByName("ArenaStar10") ~= nil then
				AddPlayerMoney(2000)
				AddPlayerItemsWithBox("storm01", 1)
				AddFadingMsgByStrIdFormatted("fm_good_added", "storm01")
				CreateNewSgNodeObject( "ET_PS_LENS_"..StarList[random(1, 4)], "ArenaStar11", -1, -1, StarCoord + CVector(0, 100, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				AddFadingMsgByStrIdFormatted("fm_arena_completed_number", 11)
			elseif GetEntityByName("ArenaStar9") ~= nil then
				CreateNewSgNodeObject( "ET_PS_LENS_"..StarList[random(1, 4)], "ArenaStar10", -1, -1, StarCoord + CVector(0, 90, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				if GetPlayerVehicle():GetPropertyById(1).AsString == "ChevC1001" then
					GetPlayerVehicle():SetNewPart("BASKET", "ChevC10Cargo04")
					GetPlayerVehicle():SetSkin(GetPlayerVehicle():GetSkin())
					AddImportantFadingMsgByStrIdFormatted("fm_arena_level10_completed")
				end
				AddFadingMsgByStrIdFormatted("fm_arena_completed_number", 10)
			elseif GetEntityByName("ArenaStar8") ~= nil then
				AddPlayerMoney(1500)
				AddPlayerItemsWithBox("book")
				AddFadingMsgByStrIdFormatted("fm_good_added", "book")
				CreateNewSgNodeObject( "ET_PS_LENS_"..StarList[random(1, 4)], "ArenaStar9", -1, -1, StarCoord + CVector(0, 80, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				AddFadingMsgByStrIdFormatted("fm_arena_completed_number", 9)
			elseif GetEntityByName("ArenaStar7") ~= nil then
				AddPlayerMoney(1000)
				AddPlayerItemsWithBox("bottle")
				AddFadingMsgByStrIdFormatted("fm_good_added", "bottle")
				CreateNewSgNodeObject( "ET_PS_LENS_"..StarList[random(1, 4)], "ArenaStar8", -1, -1, StarCoord + CVector(0, 70, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				AddFadingMsgByStrIdFormatted("fm_arena_completed_number", 8)
			elseif GetEntityByName("ArenaStar6") ~= nil then
				AddPlayerItemsWithBox("machinery")
				AddFadingMsgByStrIdFormatted("fm_good_added", "machinery")
				CreateNewSgNodeObject( "ET_PS_LENS_"..StarList[random(1, 4)], "ArenaStar7", -1, -1, StarCoord + CVector(0, 60, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				AddFadingMsgByStrIdFormatted("fm_arena_completed_number", 7)
			elseif GetEntityByName("ArenaStar5") ~= nil then
				AddPlayerItemsWithBox("fuel")
				AddFadingMsgByStrIdFormatted("fm_good_added", "fuel")
				CreateNewSgNodeObject( "ET_PS_LENS_"..StarList[random(1, 4)], "ArenaStar6", -1, -1, StarCoord + CVector(0, 50, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				AddFadingMsgByStrIdFormatted("fm_arena_completed_number", 6)
			elseif GetEntityByName("ArenaStar4") ~= nil then
				if GetPlayerVehicle():GetPropertyById(1).AsString == "ChevC1001" then
					GetPlayerVehicle():SetNewPart("CABIN", "ChevC10Cab03")
					GetPlayerVehicle():SetSkin(GetPlayerVehicle():GetSkin())
					AddImportantFadingMsgByStrIdFormatted("fm_arena_level5_completed")
				end
				CreateNewSgNodeObject( "ET_PS_LENS_"..StarList[random(1, 4)], "ArenaStar5", -1, -1, StarCoord + CVector(0, 40, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				AddFadingMsgByStrIdFormatted("fm_arena_completed_number", 5)
			elseif GetEntityByName("ArenaStar3") ~= nil then
				AddPlayerMoney(1000)
				AddPlayerItemsWithBox("oil", 1)
				AddFadingMsgByStrIdFormatted("fm_good_added", "oil")
				CreateNewSgNodeObject( "ET_PS_LENS_"..StarList[random(1, 4)], "ArenaStar4", -1, -1, StarCoord + CVector(0, 30, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				AddFadingMsgByStrIdFormatted("fm_arena_completed_number", 4)
			elseif GetEntityByName("ArenaStar2") ~= nil then
				AddPlayerMoney(1000)
				AddPlayerItemsWithBox("scrap_metal", 1)
				AddFadingMsgByStrIdFormatted("fm_good_added", "scrap_metal")
				CreateNewSgNodeObject( "ET_PS_LENS_"..StarList[random(1, 4)], "ArenaStar3", -1, -1, StarCoord + CVector(0, 20, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				AddFadingMsgByStrIdFormatted("fm_arena_completed_number", 3)
			elseif GetEntityByName("ArenaStar1") ~= nil then
				AddPlayerItemsWithBox("pkt01", 1)
				AddFadingMsgByStrIdFormatted("fm_good_added", "pkt01")
				CreateNewSgNodeObject( "ET_PS_LENS_"..StarList[random(1, 4)], "ArenaStar2", -1, -1, StarCoord + CVector(0, 10, 0), Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				AddFadingMsgByStrIdFormatted("fm_arena_completed_number", 2)
			else
				TakeQuest("Arena_Quest")
            	AddFadingMsgId( "fm_history_got" )
				AddHistory( "stranded_arena" )
				AddPlayerItemsWithBox("specter01", 1)
				AddPlayerItemsWithBox("potato", 1)
				AddFadingMsgByStrIdFormatted("fm_good_added", "specter01")
				AddFadingMsgByStrIdFormatted("fm_good_added", "potato")
				CreateNewSgNodeObject( "ET_PS_LENS_"..StarList[random(1, 4)], "ArenaStar1", -1, -1, StarCoord, Quaternion(0.0000, 0.0000, 0.0000, 1.0000), 1 )
				AddFadingMsgByStrIdFormatted("fm_arena_completed_number", 1)
			end

			if GetEntityByName("ArenaStar20") == nil then
				TActivate("trArena")
				TActivate("CreateArena")
			end
			TActivate("RemoveBarricades")
			trigger:Deactivate()
		</script>
	</trigger>

	<trigger Name="trArenaArtefactQuestNotTaken" active="0">
		<event eventid="GE_OBJECT_ENTERS_LOCATION" ObjName="BigArenaLoc" />
		<script>
			if IsQuestTaken("Stranded_ArtefactQuest_2") and not(IsQuestComplete("Stranded_ArtefactQuest_2")) then
				TActivate('Artefact3Cin')
				trigger:Deactivate()
			end
		</script>
	</trigger>
</triggers>